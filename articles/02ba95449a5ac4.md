---
title: "プルリクのレビューをチームの負担にならず素早く終わらせるために"
emoji: "🐷"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

続いては今回のチームで採用したPRレビューのルールについて紹介します。
自分やメンバーと話した結果、PRのレビューに対してチームとして以下のような共通認識がありました。

- PRのレビューまで時間がかかると、コンフリクトが発生しやすくなるため素早くレビューしたい
- しかしすぐに全員がレビューできる訳ではないので、レビューが溜まることがある
- レビューに負荷をかけすぎて、作業効率が落ちてしまうことも避けたい

そしてこれらを解決するために、以下のような案が上がりました

- 「仕様を満たしているか」と「実装がイケているか」の観点を分けてレビューしたらどうか？
  - 仕様を満たしているかのレビューはPRのレビューとして行う
  - 実装がイケているかのレビューは原則PRのレビューでは行わない
  - 実装がイケているかは別途MTGを開催してそこで話し合う

しかし、これには以下のような問題や懸念がありました

- 仕様を満たしていることの基準を誰がどうやって決めるのか？
- 実装がイケているの基準は人によって違うのではないか？
- とんでもなく汚いコードがあったとして、仕様を満たしているならそれもマージするのか？
- 定期的にMTGやるなら、結果としてそこまで作業効率が上がらないのではないか？

その後、チーム内で議論を重ね、最終的には以下のような形式になりました。

- PRが溜まってしまうことへの対策として、PRは1人がApproveした時点でマージして良い
- 情報共有の漏れを防ぐため、レビューしていないメンバーは、マージされた後でも良いので必ず中身を確認する
  - 気になることがあれば、たとえマージされていてもコメントして良い

これによって、無理に全員がレビューを急ぐ必要がなくなりました。
ただし、1人がApproveした時点でマージして良い運用にしたため、このルールを設けないとマージされたPRで交わされた議論の内容等を知らない状態になってしまいます。
また、マージ後に見た人が「ここはこうした方が良い」という意見を出すこともあるため、それらの行為を気軽に行えるための補足ルールも設けました。

そして、これらのルールを忘れ防止のために、プルリクのテンプレートを作成し、そこにも記載しておくようにしました。
参考までに使用したテンプレートを記載しておきます！

:::details PRテンプレート

```md
## チケットもしくは概要

<!--
close #XX

or

ログイン機能の実装
-->

## やったこと

<!--
- Hoge コンポーネントに props を追加
- Fuga コンポーネントを実装
-->

## 特に見て欲しいところ

<!--
- 新しいライブラリを追加したが、他に妥当な物があるか
- テストケースがこれで十分かどうか
-->

## 動作確認手順

<!--
1. ログインフォーム(/login)にアクセス
1. メアドとパスワードを入力してログインを実行する
1. ログインが成功してユーザー一覧ページにリダイレクトされること
-->

## TODO（できればIssueを立ててリンクを貼りましょう）

<!--
- [ ] バリデーション
- [ ] エラーメッセージ
-->

## その他情報

<!--
参考にした記事
-->

## レビューコメント

レビュー時は prefix（テキストでも絵文字でもOK） を付けて、どのレベル感のコメントか明示してください

- ⚠️ must:  必ず直すべき
- 💭 imo:  自分の考えは〜
- 🐾 nits: 細かい指摘
- ❓ ask:  質問/確認
- 🖊️ memo: メモ書き

## マージについて

マージするのはレビュワーでもPRを開いた人でもどちらでもOKです！
Approveはするけどコメントを残すね→開いた人が修正するかどうか判断し、そのままor修正後にマージ
完璧なPRだ！→レビュワーがそのままマージ

```

:::
